{{ define "main" }}
<content>
  {{ if .Data.Singular }}
  <h3 style="margin-bottom:0">Filtering for "{{ .Title }}"</h3>
  <small>
    <a href="{{ "blog" | relURL }}">Remove filter</a>
  </small>
  {{ end }}

  {{ if .Pages }}
    {{ $currentYear := 2025 }}
    {{ range (.Pages.GroupByDate "2006") }}
    {{ if ge (int .Key) $currentYear }}
    <h3>{{ .Key }}</h3>
    <ul class="blog-posts">
      {{ range .Pages }}
      <li>
        <span>
          <i>
            <time datetime='{{ .Date.Format "2006-01-02" }}'>
              {{ .Date.Format (default "02 Jan, 2006" .Site.Params.dateFormat) }}
            </time>
          </i>
        </span>
        <div>
          <a href="{{ .Permalink }}">{{ .Title }}</a>
          {{ if .Params.tags }}
          <div class="post-tags">
            {{ range .Params.tags }}
            <a href="{{ "tags/" | relURL }}{{ . | urlize }}" class="tag">#{{ . }}</a>
            {{ end }}
          </div>
          {{ end }}
        </div>
      </li>
      {{ end }}
    </ul>
    {{ end }}
    {{ end }}

    {{ $archivePosts := slice }}
    {{ range (.Pages.GroupByDate "2006") }}
    {{ if lt (int .Key) $currentYear }}
    {{ range .Pages }}
    {{ $archivePosts = $archivePosts | append . }}
    {{ end }}
    {{ end }}
    {{ end }}

    {{ if gt (len $archivePosts) 0 }}
    <h3>Archive</h3>
    <ul class="blog-posts archive-posts">
      {{ range $archivePosts }}
      <li>
        <span>
          <i>
            <time datetime='{{ .Date.Format "2006-01-02" }}'>
              {{ .Date.Format (default "02 Jan, 2006" .Site.Params.dateFormat) }}
            </time>
          </i>
        </span>
        <a href="{{ .Permalink }}">{{ .Title }}</a>
      </li>
      {{ end }}
    </ul>
    {{ end }}
  {{ else }}
    <ul class="blog-posts">
      <li>No posts yet</li>
    </ul>
  {{ end }}

  {{ if not .Data.Singular }}
  <small>
    <div>
      {{ range .Site.Taxonomies.tags }}
      <a href="{{ .Page.Permalink }}">#{{ .Page.Title }}</a>&nbsp;
      {{ end }}
    </div>
  </small>
  {{ end }}
</content>
{{ end }}